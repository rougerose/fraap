!function(e){function t(e,t){this.map=e,this.el=document.querySelector(t),this.directoryContainer=this.el.parentElement.parentElement,this.directoryList=this.directoryContainer.querySelector(".directory-members_list"),this.boxFilters=this.directoryContainer.previousElementSibling,this.flyToMember.bind(this),this.create()}t.prototype.create=function(){let t=this;t.sleep=L.control.toggleSleepMap({}).addTo(this.map);let o=function(){t.onclickMarker(),t.sleep.disableMap(),e("#"+t.map._container.id).off("ready",o)};e("#"+t.map._container.id).on("ready",o),t.openers=this.directoryList.querySelectorAll(".card-member");for(const e of t.openers)e.querySelector("button").addEventListener("click",t.flyToMember.bind(t));return this},t.prototype.flyToMember=function(e){let t=[],o=e.target.dataset.fraapmemberId;t.push(parseFloat(e.target.dataset.fraapmemberLat)),t.push(parseFloat(e.target.dataset.fraapmemberLon)),this._scrollUI(),this.map.flyTo(t,15),this.openMemberPopup(o),this._toggleMember(o)},t.prototype.onclickMarker=function(){let t=this;this.map.eachLayer((function(o){o.on("click",(function(e){this.feature&&(t._scrollUI(),t._toggleMember(this.feature.id))})),t.map.options.cluster&&void 0!==o.getChildCount&&e.each(o.getAllChildMarkers(),(function(e,o){o.on("click",(function(){this.feature&&(t._scrollUI(),t._toggleMember(this.feature.id))}))}))}))},t.prototype._scrollUI=function(){0==this.boxFilters.offsetTop?this.boxFilters.scrollIntoView({behavior:"smooth"}):this.boxFilters.offsetTop>0&&window.scrollTo({top:this.directoryContainer.offsetParent.offsetTop,left:0,behavior:"smooth"})},t.prototype._toggleMember=function(e){let t=this.directoryContainer.querySelector("#member-"+e);this.openers.forEach((e=>{e.classList.contains("is-active")&&e.classList.remove("is-active")})),t.classList.add("is-active"),this.directoryList.scrollTo({top:t.offsetTop-1,left:0,behavior:"smooth"})},t.prototype.openMemberPopup=function(e){let t,o=this.map,r=0;for(t in o._layers){if(L.MarkerClusterGroup&&o._layers[t]instanceof L.MarkerClusterGroup){if(o._layers[t].eachLayer((function(i){i.id&&i.id==e&&(o._layers[t].zoomToShowLayer(i,(function(){i.openPopup()})),r++)})),r>0)break}else if(o._layers[t].feature&&o._layers[t].feature.id==e||o._layers[t].id&&o._layers[t].id==e){o.centerAndZoom(o._layers[t].getLatLng(),!0),o._layers[t].openPopup();break}r++}},window.callback_map_members=function(e){new t(e,"#map_members")}}($);
