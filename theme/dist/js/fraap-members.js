var FraapMembers=function(e){"use strict";function t(e){this.map=e,this.container=e._container.parentElement.parentElement,this.list=this.container.querySelector("[role='list']"),this.bar=this.container.previousElementSibling,this.flyToMember.bind(this),this.create()}return t.prototype.create=function(){let t=this,o=function(){t.onclickMarker(),t.sleep.disableMap(),e("#"+t.map._container.id).off("ready",o)};var r,i,a;return t.sleep=L.control.toggleSleepMap({}).addTo(this.map),e("#"+t.map._container.id).on("ready",o),t.openers=(r=".card-member",i=this.container,a=(i||document).querySelectorAll(r),Array.prototype.slice.call(a)),t.openers.forEach((e=>{e.querySelector("button").addEventListener("click",t.flyToMember.bind(t))})),this},t.prototype.flyToMember=function(e){let t=[],o=e.target.dataset.fraapmemberId;t.push(parseFloat(e.target.dataset.fraapmemberLat)),t.push(parseFloat(e.target.dataset.fraapmemberLon)),this._scrollUI(),this.map.flyTo(t,15),this.openMemberPopup(o),this._toggleMember(o)},t.prototype.onclickMarker=function(){let t=this;this.map.eachLayer((function(o){o.on("click",(function(e){this.feature&&(t._scrollUI(),t._toggleMember(this.feature.id))})),t.map.options.cluster&&void 0!==o.getChildCount&&e.each(o.getAllChildMarkers(),(function(e,o){o.on("click",(function(){this.feature&&(t._scrollUI(),t._toggleMember(this.feature.id))}))}))}))},t.prototype._scrollUI=function(){0==this.bar.offsetTop?this.bar.scrollIntoView({behavior:"smooth"}):this.bar.offsetTop>0&&window.scrollTo({top:this.container.offsetParent.offsetTop,left:0,behavior:"smooth"})},t.prototype._toggleMember=function(e){let t=this.container.querySelector("#member-"+e);this.openers.forEach((e=>{e.classList.contains("is-active")&&e.classList.remove("is-active")})),t.classList.add("is-active"),this.list.scrollTo({top:t.offsetTop-1,left:0,behavior:"smooth"})},t.prototype.openMemberPopup=function(e){let t,o=this.map;for(t in o._layers)if(o._layers[t].feature&&o._layers[t].feature.id==e||o._layers[t].id&&ma._layers[t].id==e){o.centerAndZoom(o._layers[t].getLatLng(),!1),o._layers[t].openPopup();break}},t}($);
