/// PROSE / PROSE-EDITOR
/// https://github.com/GoogleChrome/web.dev/blob/main/src/scss/blocks/_prose.scss

@use "../utilities/wrapper-content";
@use "../utilities/flow";
@use "../settings";
@use "sass:math";

.prose {
  --flow-space: var(--space-m);

  @extend .flow;
  @extend .wrapper-content;
  max-width: #{math.div(settings.$FRAAP-PROSE-MAX-WIDTH, 16) * 1rem};

  // Variant offset-icon (rubrique et certains articles).
  &.with-offset-icon {
    padding-left: 0;
  }

  // Règles de marges (flow)
  figure,
  figure + *,
  aside,
  aside + *,
  h2 {
    --flow-space: var(--space-xl);
  }

  h3,
  h4,
  h5,
  h6 {
    --flow-space: var(--space-l);
  }

  h2 + *,
  h3 + *,
  h4 + *,
  h5 + * {
    --flow-space: var(--space-s);
  }

  h2 + h3,
  h3 + h4,
  h5 + h6 {
    --flow-space: var(--space-l);
  }

  // Etendue des lignes/blocs
  h2,
  h3,
  h4,
  h5,
  h6 {
    max-width: 50ch;
  }

  p,
  li,
  hr {
    max-width: 70ch;
  }

  > img,
  > table {
    width: 100%;
  }

  // Ancre des les intertitres
  h2,
  h3,
  h4,
  h5,
  h6 {
    a[href^="#"] {
      color: transparent;
      font-weight: 600;
      text-decoration: none;
      transition: color 0.3s;
    }

    &:hover a[href^="#"],
    a[href^="#"]:focus {
      color: var(--color-link);
    }
  }


  /// Details gets more surrounding space, but the inner elements
  /// should all be equal
  // details,
  // details + * {
  //   --flow-space: var(--space-xl);
  // }

  // details + details {
  //   margin-top: 0;
  // }

  // details > * {
  //   --flow-space: var(--space-m);
  // }

}

// .prose-editor
// Cibler les blocs d'édition de spip afin d'éviter des conflits
// notamment entre les listes de texte et la table des matière
// (de type inner).
.prose-editor {

  a[class*="spip"] {
    color: var(--color-link);
  }

  a[class*="spip"]:visited {
    color: var(--color-link-visited);
  }

  // Lien spip_note
  a.spip_note {
    background-color: var(--color-link);
    border-radius: 2px;
    color: var(--color-paper);
    font-size: 0.8em;
    padding: 3px 2px 0px;
    transition: background 0.3s;

    &:hover {
      background-color: var(--color-contrast-300);
      text-decoration: none;
    }

    &:visited {
      color: var(--color-paper);
    }
  }

  // Icone sur les liens externes
  a.spip_out {
    &::after {
      background-color: currentColor;
      content: "";
      display: inline-flex;
      margin-left: 4px;
      mask-image: url(../../images/icon-link-external-16.svg);
      mask-size: cover;
      width: 12px;
      height: 12px;
    }
  }


  ul.spip,
  ol.spip {
    --flow-space: var(--space-xs);
    > li + li {
      margin-top: var(--flow-space);
    }
  }
}
