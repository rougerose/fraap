<BOUCLE_article_fiche_pratique(ARTICLES){id_article}>
  #SET{mots, #ARRAY} #SET{groupes, #ARRAY} #SET{id_groupe_mot, ''} #SET{id_groupe_env, #ENV{id_groupe, ''}}

  <BOUCLE_mots(MOTS){id_article}>
    [(#SET{mots, #GET{mots}|push{#ID_MOT}})]
  </BOUCLE_mots>
  [(#REM)
    <!--
      1- Récupérer la variable id_groupe : privilégier celle en cours de consultation si elle existe parmi les mots liés à l'article ; sinon la première de la série.
      2- Constituer le tableau dédoublé des id_groupe liés à l'article.
    -->
  ]
  <BOUCLE_groupes_article(MOTS){id_article}{fusion_supprimer}{fusion id_groupe}>
    [(#ID_GROUPE|=={#ENV{id_groupe}}|oui)
      [(#GET{id_groupe_mot}|non) #SET{id_groupe_mot, #ID_GROUPE} ]
    ]
    [(#SET{groupes, #GET{groupes}|push{#ID_GROUPE}})]
  </BOUCLE_groupes_article>
  <BOUCLE_premier_groupe_article(GROUPES_MOTS){id_groupe IN #GET{groupes}}{par titre}{0,1}{si #GET{id_groupe_mot}|non}>
    #SET{id_groupe_mot, #ID_GROUPE}
  </BOUCLE_premier_groupe_article>
  [(#REM)
    <!-- Si l'article est consulté sans le paramètre id_groupe, on utilise celui qui vient d'être récupéré pour constituer un fil d'Ariane complet. -->
  ][(#GET{id_groupe_env}|non) #SET{id_groupe_env, #GET{id_groupe_mot}} ]
  [(#REM)
    <!-- Sommaire -->
  ][(#SET{sommaire, #SOMMAIRE{#TEXTE}|ajouter_styles_toc|supprimer_soulignement})]
  <div class="page" data-page="article">
    <div class="wrapper-structure">
      <INCLURE{fond=inclure/breadcrumb/article-fiches-pratiques, id_article, id_rubrique, id_groupe=#GET{id_groupe_env}}/>
    </div>
    <div class="wrapper-content" data-flush>
      <div class="region">
        <article class="article">
          <div class="with-sidebar flex-dir-rev flex-align-start flex-wrap-no">
            [(#GET{sommaire}|oui)<div class="toc" data-type="layout-only"></div>]
            <div class="prose">
              <header class="headline">
                <h1 class="headline_title variant-article">#TITRE</h1>
                [<p class="headline_subtitle">(#SOUSTITRE)</p>]
                [<div class="headline_desc variant-article flow measure prose-editor">(#CHAPO)</div>]
                [(#REM) <!-- Date de publication et éventuellement date de modification si supérieure à 24h après la date de publication  --> ]
                <p class="headline_date"><:fraap_squelettes:date_publication_fiche:><time datetime="[(#DATE|date_iso)]">[(#DATE|affdate)]</time>[(#DATE_MODIF|affdate{U}|moins{#DATE|affdate{U}}|>{86400}|?{[<:fraap_squelettes:date_mise_a_jour_fiche:><time datetime="[(#DATE_MODIF|date_iso)]">(#DATE_MODIF|affdate)</time>.], '.'})]</p>
              </header>
            </div>
          </div>
          <div class="with-sidebar flex-dir-rev flex-align-start flex-wrap-no">
            [<nav class="toc gap-top-5 flow-small" data-type="side">
              <h2 class="toc_heading"><:fraap_squelettes:toc_titre:></h2>
              (#GET{sommaire})
            </nav>]
            <div class="prose">
              [<div class="toc gap-top-5" data-type="inner">
                <details role="navigation">
                  <summary><:fraap_squelettes:toc_titre:></summary>
                  (#GET{sommaire})
                </details>
              </div>]
              [<div class="flow gap-top-5 prose-editor">
                (#TEXTE|ancres_sommaire)
              </div>]
              [<div class="notes auto-grid gap-top-6 prose-editor">
                (#NOTES)
              </div>]
            </div>
          </div>
        </article>
        <B_liste_secondaire>
          <br><br>
          <h4>Mot-clés rôle secondaire</h4>
          <br>
          <p>
            <BOUCLE_liste_secondaire(MOTS){id_article}{role=secondaire}{doublons}{', '}>#TITRE</BOUCLE_liste_secondaire>
          </p>
        </B_liste_secondaire>
        <B_liste_normale>
          <br><br>
          <p>
            <h4>Mots-clés rôle normal</h4>
            <br>
            <BOUCLE_liste_normale(MOTS){id_article}{role=normal}{doublons}{', '}>#TITRE</BOUCLE_liste_normale>
          </p>
        </B_liste_normale>
      </div>
    </div>

    <B_prolonger>
      <section class="pod variant-banner related">
        <div class="pod_mask">
          <div class="pod_bg-mask">
            <div class="pod_bg-banner"></div>
          </div>
          <div class="wrapper-content">
            <div class="pod_content">
              <h2 class="pod_headline"><:fraap_squelettes:prolonger_headline:> (mots-clés)</h2>
              <ul class="related_list auto-grid gap-top-3" role="list">
                <BOUCLE_prolonger(ARTICLES){mots 0.5 #GET{mots} !tri}{exclus}>
                  <li class="card variant-box related_item flow">
                    <h3 class="card_heading"><a href="[(#URL_ARTICLE|parametre_url{id_groupe, #GET{id_groupe_mot}})]">#TITRE</a></h3>
                    <B_article_prolonger_groupes>
                      <p class="cluster">
                        <BOUCLE_article_prolonger_groupes(MOTS){id_article}{fusion_supprimer}{fusion id_groupe}>
                          <a href="[(#URL_RUBRIQUE|parametre_url{id_groupe, #ID_GROUPE})]" class="pill">#INFO_TITRE{groupe_mots, #ID_GROUPE}</a>
                        </BOUCLE_article_prolonger_groupes>
                      </p>
                    </B_article_prolonger_groupes>
                    <p class="cluster">
                      <BOUCLE_get_mots(MOTS){id_article}>
                        #TITRE<br>
                      </BOUCLE_get_mots>
                    </p>
                  </li>
                </BOUCLE_prolonger>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </B_prolonger>

    <B_prolonger_liaisons>
      <section class="pod variant-banner related">
        <div class="pod_mask">
          <div class="pod_bg-mask">
            <div class="pod_bg-banner"></div>
          </div>
          <div class="wrapper-content">
            <div class="pod_content">
              <h2 class="pod_headline"><:fraap_squelettes:prolonger_headline:> (liaisons «&nbsp;à la main&nbsp;» entre articles)</h2>
              <ul class="related_list auto-grid gap-top-3" role="list">
                <BOUCLE_prolonger_liaisons(ARTICLES_LIES){id_article}{type_liaison=prolonger}{par rang}>
                  <li class="card variant-box related_item flow">
                    <h3 class="card_heading"><a href="#URL_ARTICLE{#ID_ARTICLE_LIE}">#INFO_TITRE{article, #ID_ARTICLE_LIE}</a></h3>
                    <B_article_liaison_prolonger_groupes>
                      <p class="cluster">
                        <BOUCLE_article_liaison_prolonger_groupes(MOTS){id_article=#ID_ARTICLE_LIE}{fusion_supprimer}{fusion id_groupe}>
                          <a href="[(#URL_RUBRIQUE|parametre_url{id_groupe, #ID_GROUPE})]" class="pill">#INFO_TITRE{groupe_mots, #ID_GROUPE}</a>
                        </BOUCLE_article_liaison_prolonger_groupes>
                      </p>
                    </B_article_liaison_prolonger_groupes>
                  </li>
                </BOUCLE_prolonger_liaisons>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </B_prolonger_liaisons>

  </div>
</BOUCLE_article_fiche_pratique>
#FILTRE{trim}
