[(#REM)
	tableau pour stocker les données du formulaires
	- regions = les régions,
	- competences = les compétences et les domaines recherchés (les données sont les mêmes)
]
	#SET{regions,#ARRAY} #SET{competences,#ARRAY}

<BOUCLE_yaml(DATA){source yaml, #CHEMIN{formulaires/stages.yaml}}>
[(#CLE|=={regions}|oui)[(#SET{regions, #VALEUR})]]
[(#CLE|=={competences}|oui)[(#SET{competences,#VALEUR})]]
</BOUCLE_yaml>

<BOUCLE_candidatures(CANDIDATURES){tout}>
#SET_PUSH{candidatures,#ID_CANDIDATURE}
</BOUCLE_candidatures>

[(#REM)
	tableau des offres disponibles.

	TODO il faudra ajouter les critères de tri de l'utilisateur
]



[(#REM) zone relative à la session ouverte par l'utilisateur ]
<INCLURE{fond=inclure/session-info,env}>


<B_stages>
<table id="stages-table">
	<thead>
		<tr>
			<th></th>
			<th>Candidat(e)</th>
			<th colspan="2"><:candidatures:label_dispo_consultation:></th>
			<th colspan="2"><:candidatures:label_localisation_geo_consultation_abrev:></th>
			<th colspan="4"><:candidatures:label_formation_consultation:></th>
			<th colspan="2"><:candidatures:label_competences_recherches_consultation:></th>
		</tr>
		<tr>
			<th></th><th>Prénom Nom</th>
			<th><:candidatures:label_date_debut:></th><th><:candidatures:label_date_fin:></th>
			<th><:candidatures:label_regions_consultation_abrev:></th><th><:candidatures:label_ville_consultation:></th>
			<th><:candidatures:label_ecole:></th><th><:candidatures:label_ville_consultation:></th><th><:candidatures:label_diplome:></th><th><:candidatures:label_diplome_niveau:></th>
			<th><:candidatures:label_competences_consultation:></th>
			<th><:candidatures:label_recherches_consultation:></th>
		</tr>
	</thead>
	<tbody>
		<BOUCLE_stages(CANDIDATURES){id_candidature IN #GET{candidatures}}>

		[(#REM) prenom et initiale nom du candidat ]
		<BOUCLE_auteur_form(FORMULAIRES_REPONSES auteurs){id_formulaires_reponse}>
		#SET{auteur_prenom,#PRENOM}[(#SET{auteur_nom,#NOM})]</BOUCLE_auteur_form>

		#SET{reg,#REGIONS|unserialize}
		#SET{comp,#COMPETENCES|unserialize}
		#SET{rech,#RECHERCHES|unserialize}
		<tr id="stage#ID_FORMULAIRES_REPONSE" class="[(#COMPTEUR_BOUCLE|alterner{'impaire','pair'})][ (#COMPTEUR_BOUCLE|modulo{3})]">
			<td rowspan="2"><a href="#">b</a></td>
			<td>#GET{auteur_prenom}</td>
			<td>[(#DATE_DEBUT|affdate{d/m/Y})]</td>
			<td>[(#DATE_FIN|affdate{d/m/Y})]</td>
			<td>
				<BOUCLE_r(POUR){tableau #GET{reg}}>
				[<p[(#ENV{regions}|find{#VALEUR}|oui) class="on"]>(#GET{selection}|table_valeur{#VALEUR})</p>]
				</BOUCLE_r>
			</td>
			<td>#VILLE_STAGE</td>
			<td>#ECOLE</td>
			<td>#VILLE_ECOLE</td>
			<td>#DIPLOME</td>
			<td>#NIVEAU</td>
			<td>
				<BOUCLE_c(POUR){tableau #GET{comp}}>
				[<p[(#ENV{competences}|find{#VALEUR}|oui) class="on"]>(#GET{checkbox}|table_valeur{#VALEUR})</p>]
				</BOUCLE_c>
			</td>
			<td>
				<BOUCLE_re(POUR){tableau #GET{rech}}>
				[<p[(#ENV{recherches}|find{#VALEUR}|oui) class="on"]>(#GET{checkbox}|table_valeur{#VALEUR})</p>]
				</BOUCLE_re>
			</td>
		</tr>
		<tr class="[(#COMPTEUR_BOUCLE|alterner{'impaire enfant','pair enfant'})]">
			<td colspan="11">#GET{auteur_nom}</td>
		</tr>
		</BOUCLE_stages>
	</tbody>
</table>
</B_stages>
<p><:candidatures:info_pas_de_resultat_stages:></p>
<//B_stages>